{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Nutzer/Desktop/react/linkedin-clone/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Nutzer/Desktop/react/linkedin-clone/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{auth,provider,storage}from\"../firebase\";import db from\"../firebase\";import{SET_USER,SET_LOADING_STATUS,GET_ARTICLES}from\"./actionType\";export var setUser=function setUser(payload){return{//setUser takes a payload\ntype:SET_USER,user:payload// is setted to whatever the payload is\n};};export var setLoading=function setLoading(status){return{type:SET_LOADING_STATUS,status:status// status is gonna be whatever was passed into status\n};};export var getArticles=function getArticles(payload){return{type:GET_ARTICLES,payload:payload};};export function signInAPI(){return function(dispatch){auth.signInWithPopup(provider).then(function(payload){dispatch(setUser(payload.user));//payload is all of the user details -> dispatched to SET_USER\n}).catch(function(error){return alert(error.message);});};}export function getUserAuth(){return function(dispatch){auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(user){dispatch(setUser(user));}case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};}export function signOutAPI(){return function(dispatch){auth.signOut().then(function(){dispatch(setUser(null));}).catch(function(error){console.log(error.message);});};}export function postArticleAPI(payload){//is used to upload the image\nreturn function(dispatch){dispatch(setLoading(true));if(payload.image!=\"\"){var upload=storage.ref(\"images/\".concat(payload.image.name)).put(payload.image);//payload is the contents/message of a action\nupload.on(\"state_changed\",function(snapshot){var progress=snapshot.bytesTransferred/snapshot.totalBytes*100;//for making the loading bar\nconsole.log(\"Progress: \".concat(progress,\"%\"));if(snapshot.state===\"RUNNING\"){console.log(\"Progress: \".concat(progress,\"%\"));}},function(error){return console.log(error.code);},/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var downloadURL;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return upload.snapshot.ref.getDownloadURL();case 2:downloadURL=_context2.sent;db.collection(\"articles\").add({actor:{description:payload.user.email,title:payload.user.displayName,date:payload.timestamp,image:payload.user.photoURL},video:payload.video,sharedImg:downloadURL,comments:0,description:payload.description});dispatch(setLoading(false));case 5:case\"end\":return _context2.stop();}}},_callee2);})));}else if(payload.video){db.collection(\"articles\").add({actor:{description:payload.user.email,title:payload.user.displayName,date:payload.timestamp,image:payload.user.photoURL},video:payload.video,sharedImg:\"\",comments:0,description:payload.description});dispatch(setLoading(false));}};}export function getArticlesAPI(){return function(dispatch){var payload;db.collection(\"articles\").orderBy(\"actor.date\",\"desc\").onSnapshot(function(snapshot){//read data from firebase\npayload=snapshot.docs.map(function(doc){return doc.data();});// Put all documents that were retrieved from firebase in an array\ndispatch(getArticles(payload));});};}","map":{"version":3,"sources":["C:/Users/Nutzer/Desktop/react/linkedin-clone/src/actions/index.js"],"names":["auth","provider","storage","db","SET_USER","SET_LOADING_STATUS","GET_ARTICLES","setUser","payload","type","user","setLoading","status","getArticles","signInAPI","dispatch","signInWithPopup","then","catch","error","alert","message","getUserAuth","onAuthStateChanged","signOutAPI","signOut","console","log","postArticleAPI","image","upload","ref","name","put","on","snapshot","progress","bytesTransferred","totalBytes","state","code","getDownloadURL","downloadURL","collection","add","actor","description","email","title","displayName","date","timestamp","photoURL","video","sharedImg","comments","getArticlesAPI","orderBy","onSnapshot","docs","map","doc","data"],"mappings":"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","sourcesContent":["import { auth, provider, storage } from \"../firebase\";\r\nimport db from \"../firebase\";\r\nimport { SET_USER, SET_LOADING_STATUS, GET_ARTICLES } from \"./actionType\";\r\n\r\nexport const setUser = (payload) => ({\r\n  //setUser takes a payload\r\n  type: SET_USER,\r\n  user: payload, // is setted to whatever the payload is\r\n});\r\n\r\nexport const setLoading = (status) => ({\r\n  type: SET_LOADING_STATUS,\r\n  status: status, // status is gonna be whatever was passed into status\r\n});\r\n\r\nexport const getArticles = (payload) => ({\r\n  type: GET_ARTICLES,\r\n  payload: payload,\r\n});\r\n\r\nexport function signInAPI() {\r\n  return (dispatch) => {\r\n    auth\r\n      .signInWithPopup(provider)\r\n      .then((payload) => {\r\n        dispatch(setUser(payload.user)); //payload is all of the user details -> dispatched to SET_USER\r\n      })\r\n      .catch((error) => alert(error.message));\r\n  };\r\n}\r\n\r\nexport function getUserAuth() {\r\n  return (dispatch) => {\r\n    auth.onAuthStateChanged(async (user) => {\r\n      if (user) {\r\n        dispatch(setUser(user));\r\n      }\r\n    });\r\n  };\r\n}\r\n\r\nexport function signOutAPI() {\r\n  return (dispatch) => {\r\n    auth\r\n      .signOut()\r\n      .then(() => {\r\n        dispatch(setUser(null));\r\n      })\r\n      .catch((error) => {\r\n        console.log(error.message);\r\n      });\r\n  };\r\n}\r\n\r\nexport function postArticleAPI(payload) {\r\n  //is used to upload the image\r\n\r\n  return (dispatch) => {\r\n    dispatch(setLoading(true));\r\n    if (payload.image != \"\") {\r\n      const upload = storage\r\n        .ref(`images/${payload.image.name}`)\r\n        .put(payload.image); //payload is the contents/message of a action\r\n      upload.on(\r\n        \"state_changed\",\r\n        (snapshot) => {\r\n          const progress =\r\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100; //for making the loading bar\r\n\r\n          console.log(`Progress: ${progress}%`);\r\n          if (snapshot.state === \"RUNNING\") {\r\n            console.log(`Progress: ${progress}%`);\r\n          }\r\n        },\r\n        (error) => console.log(error.code),\r\n        async () => {\r\n          const downloadURL = await upload.snapshot.ref.getDownloadURL();\r\n          db.collection(\"articles\").add({\r\n            actor: {\r\n              description: payload.user.email,\r\n              title: payload.user.displayName,\r\n              date: payload.timestamp,\r\n              image: payload.user.photoURL,\r\n            },\r\n            video: payload.video,\r\n            sharedImg: downloadURL,\r\n            comments: 0,\r\n            description: payload.description,\r\n          });\r\n          dispatch(setLoading(false));\r\n        }\r\n      );\r\n    } else if (payload.video) {\r\n      db.collection(\"articles\").add({\r\n        actor: {\r\n          description: payload.user.email,\r\n          title: payload.user.displayName,\r\n          date: payload.timestamp,\r\n          image: payload.user.photoURL,\r\n        },\r\n        video: payload.video,\r\n        sharedImg: \"\",\r\n        comments: 0,\r\n        description: payload.description,\r\n      });\r\n      dispatch(setLoading(false));\r\n    }\r\n  };\r\n}\r\n\r\nexport function getArticlesAPI() {\r\n  return (dispatch) => {\r\n    let payload;\r\n    db.collection(\"articles\")\r\n      .orderBy(\"actor.date\", \"desc\")\r\n      .onSnapshot((snapshot) => {\r\n        //read data from firebase\r\n        payload = snapshot.docs.map((doc) => doc.data()); // Put all documents that were retrieved from firebase in an array\r\n        dispatch(getArticles(payload));\r\n      });\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}